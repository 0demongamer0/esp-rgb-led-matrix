# esp-rgb-led-matrix
Full RGB LED matrix, based on an ESP32 and WS2812B LEDs.

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](http://choosealicense.com/licenses/mit/)

## Electronic

### System Diagram

![system-diagram](https://github.com/BlueAndi/esp-rgb-led-matrix/blob/master/doc/design/system.png)

### NodeMCU ESP-32S

The [NodeMCU development board ESP-32S](https://docs.zerynth.com/latest/official/board.zerynth.nodemcu_esp/docs/index.html) is used.

| Dev. Board ESP-32S Pin | ESP32 Pin | Function on Dev. Board ESP-32S |
| --- | --- | --- |
| VIN (J1-1) | VIN | |
| GND (J1-2) | GND | |
| D13 (J1-3) | GPIO 13 | |
| D12 (J1-4) | GPIO 12 | |
| D14 (J1-5) | GPIO 14 | |
| D27 (J1-6) | GPIO 27 | |
| D26 (J1-7) | A9 | |
| D25 (J1-8) | A8 | |
| D33 (J1-9) | A5 | |
| D32 (J1-10) | A4 | |
| D35 (J1-11) | A7 | |
| D34 (J1-12) | A6 | |
| VN (J1-13) | VN | |
| VP (J1-14) | VP | |
| EN (J1-15); 10k Pull-Up | EN | Button on board, closing to GND; USB RTS |
| VDD3V3 (J2-1) | VDD3V3 | |
| GND (J2-2) | GND | |
| D15 (J2-3) | GPIO 15 | |
| D2 (J2-4); Blue LED | GPIO 2 | |
| D4 (J2-5) | GPIO 4 | |
| RX2 (J2-6) | RX2 | |
| TX2 (J2-7) | TX2 | |
| D5 (J2-8); 10k Pull-Up | GPIO 5 | |
| D18 (J2-9) | GPIO 18 | |
| D19 (J2-10) | GPIO 19 | |
| D21 (J2-11) | GPIO 21 | |
| RX0 (J2-12) | RX0 | USB RX |
| TX0 (J2-13); 10k Pull-Up | TX0 | USB TX |
| D22 (J2-14) | GPIO 22 | |
| D23 (J2-15) | GPIO 23 | |
| - | GPIO 0 | 10k Pull-Up; Button on board, closing to GND; USB DTR |

### LED Matrix

The LED matrix consists of 8 x 32 WS2812B LEDs. Each LED has a max. current of 60 mA, which would result in a max. power consumption of 5 V / 15.36 A. The flexible LED panel matrix would be damaged with this high nominal power consumption, therefore it shall be limited to 5 V / 4 A.

Input voltage level:
* High - Min. 0.7 * VDD
  * => 0.7 * 5 V = 3.5 V
* Low - Max. 0.3 * VDD
  * => 0.3 * 5 V = 1.5 V

The I/O pins of the Wemos D1 mini are running with a 3.3 V level, which could cause a problem in detection a high!

Therefore the level must be shifted from 3.3 V to 5V.

### Ambient Light Sensor

The following table shows the output voltage, generated by a LDR like the GL5528 and a 1 k resistor. Both assembled as voltage divider.

| Ambient light | Ambient light | Photocell resistance | LDR + R | Voltage across R|
| --- | --- | --- | --- | --- |
| Moonlit night | 1 lux | 70 kΩ | 71 kΩ | 0.046 V |
| Dark room | 10 lux | 10 kΩ | 11 kΩ | 0.3 V |
| Dark overcast day / Bright room | 100 lux | 1.5 kΩ | 2.5 kΩ | 1.32 V |
| Overcast day | 1000 lux | 300 Ω | 1.3 kΩ | 2.538 V |
| Full daylight | 10,000 lux | 100 Ω | 1.1 kΩ | 3.0 V |

## Issues, Ideas and bugs
If you have further ideas or you found some bugs, great! Create a [issue](https://github.com/BlueAndi/esp-rgb-led-matrix/issues) or if you are able and willing to fix it by yourself, clone the repository and create a pull request.

## License
The whole source code is published under the [MIT license](http://choosealicense.com/licenses/mit/).
