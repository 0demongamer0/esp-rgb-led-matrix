# esp-rgb-led-matrix
Full RGB LED matrix, based on an ESP and WS2812B LEDs.

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](http://choosealicense.com/licenses/mit/)

## Electronic

### System diagram

![system-diagram](https://github.com/BlueAndi/esp-rgb-led-matrix/blob/master/doc/design/system.png)

### Wemos D1 mini

| Wemos D1 mini Pin | Function | ESP-8266 Pin | Connected to |
| --- | --- | --- | --- |
| TX | TXD | TXD | - |
| RX | RXD | RXD | - |
| A0 | Analog input, max 3.3V input | A0 | - |
| D0 | I/O | GPIO16 | - |
| D1 | I/O, SCL | GPIO5 | - |
| D2 | I/O, SDA | GPIO4 | - |
| D3 | I/O, 10k Pull-up | GPIO0 | Button |
| D4 | I/O, 10k Pull-up, BUILTIN_LED | GPIO2 | - |
| D5 | I/O, SCK | GPIO14 | - |
| D6 | I/O, MISO | GPIO12 | - |
| D7 | I/O, MOSI | GPIO13 | LED matrix data in |
| D8 | I/O, 10k Pull-down, SS | GPIO15 | - |
| G | Ground | GND | GND |
| 5V | 5V | - | VCC-PROTECTED |
| 3V3 | 3.3V | 3.3V | VCC-3V3 |
| RST | Reset | RST | - |

Important note: All of the I/O pins run at 3.3 V.

### LED Matrix

The LED matrix consists of 8 x 12 WS2812B LEDs. Each LED has a max. current of 60 mA, which would result in a max. power consumption of 5 V / 15.36 A. The flexible LED panel matrix would be damaged with this high nominal power consumption, therefore it shall be limited to 5 V / 4 A.

Input voltage level:
* High - Min. 0.7 * VDD
  * => 0.7 * 5 V = 3.5 V
* Low - Max. 0.3 * VDD
  * => 0.3 * 5 V = 1.5 V

The I/O pins of the Wemos D1 mini are running with a 3.3 V level, which could cause a problem in detection a high!

Therefore the level must be shifted from 3.3 V to 5V.

### Ambient light sensor

The following table shows the output voltage, generated by a LDR like the GL5528 and a 1 k resistor. Both assembled as voltage divider.

| Ambient light | Ambient light | Photocell resistance | LDR + R | Voltage across R|
| --- | --- | --- | --- | --- | --- |
| Moonlit night | 1 lux | 70 kΩ | 71 kΩ | 0.046 V |
| Dark room | 10 lux | 10 kΩ | 11 kΩ | 0.3 V |
| Dark overcast day / Bright room | 100 lux | 1.5 kΩ | 2.5 kΩ | 1.32 V |
| Overcast day | 1000 lux | 300 Ω | 1.3 kΩ | 2.538 V |
| Full daylight | 10,000 lux | 100 Ω | 1.1 kΩ | 3.0 V |

